name: Sync to Techievenki Portfolio

on:
  push:
    branches:
      - main  # Change to 'master' if that's your default branch
      - gh-pages  # If you're using gh-pages branch

jobs:
  sync:
    runs-on: ubuntu-latest
    
    steps:
      - name: Checkout main repository
        uses: actions/checkout@v4
        with:
          fetch-depth: 0  # Get full history
          token: ${{ secrets.OMNISTACK_TOKEN }}
          lfs: true  # Add this line to fetch LFS files

      - name: Checkout LFS objects
        run: git lfs pull  # Ensure all LFS objects are downloaded

      - name: Push to techievenki portfolio repository
        env:
          OMNISTACK_TOKEN: ${{ secrets.OMNISTACK_TOKEN }}
        run: |
          # Configure git
          git config --global user.name "GitHub Actions Bot"
          git config --global user.email "actions@github.com"
          
          # Add the techievenki portfolio repo as a remote.
          git remote add techievenki https://x-access-token:${OMNISTACK_TOKEN}@github.com/techyvenki/omnistack.git
          
          # Push to techievenki portfolio repo (force push to keep them identical)
          git push techievenki HEAD:main --force
          
          echo "âœ… Successfully synced to omnistack repository!"
